<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Rendevous Hashing | aadalal</title><meta name="description" content="Generated by create next app"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="next-head-count" content="4"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous"/><link rel="icon" href="favicon.ico"/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/5c882c34218f54b4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5c882c34218f54b4.css" data-n-g=""/><link rel="preload" href="/_next/static/css/19b6bbb85053155c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/19b6bbb85053155c.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/darkmode-load.js" defer="" data-nscript="beforeInteractive"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-83cebdb887f48834.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2dfd096757008a0f.js" defer=""></script><script src="/_next/static/chunks/996-502a5e68cb1e9d91.js" defer=""></script><script src="/_next/static/chunks/236-56896faab121b877.js" defer=""></script><script src="/_next/static/chunks/pages/p/%5Bslug%5D-2d1ce316d81bb9cb.js" defer=""></script><script src="/_next/static/BneLi1I7rvmm171Kn3ut3/_buildManifest.js" defer=""></script><script src="/_next/static/BneLi1I7rvmm171Kn3ut3/_ssgManifest.js" defer=""></script></head><body><div id="__next"><main class="__className_a64ecd"><div class="full grid grid-cols-8 font-medium"><div class="col-span-8 md:col-span-2 p-4 border-2 flex flex-row justify-between items-center flex-shrink"><a class="font-bold text-xl" href="/">aadalal</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" color="black" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" style="cursor:pointer;transform:rotate(90deg)"><mask id="circle-mask"><rect x="0" y="0" width="100%" height="100%" fill="white"></rect><circle style="cx:100%;cy:0%" r="9" fill="black"></circle></mask><circle cx="12" cy="12" fill="black" style="r:5px" mask="url(#circle-mask)"></circle><g stroke="currentColor" style="opacity:1"><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></g></svg></div><div class="col-span-0 hidden md:col-span-6 py-4 px-2 border-y-2 border-r-2 md:grid grid-cols-16 gap-6 overflow-hidden whitespace-nowrap items-center justify-center"><div class="col-span-5 flex justify-end items-center flex-shrink gap-5"><a class="opacity-75" href="/p/consistent-hashing">Consistent Hashing</a></div><div class="col-span-6 flex flex-row justify-between items-center flex-shrink-0 z-10"><a id="previous-post" class="" href="/p/consistent-hashing"><svg xmlns="http://www.w3.org/2000/svg" class="h-8" fill="currentColor" viewBox="144 64 224 384"><path d="M368 64L144 256l224 192V64z"></path></svg></a><div class="shrink text-2xl font-junicode bg-white dark:bg-black">Rendevous Hashing</div><a id="next-post" class="" href="/p/py-generator-couroutines"><svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="h-8 dark:text-white" viewBox="144 64 224 384"><path d="M144 448l224-192L144 64v384z"></path></svg></a></div><div class="col-span-5 flex justify-start items-center flex-shrink gap-5"><a class="opacity-75" href="/p/py-generator-couroutines">Python Coroutines!?!?</a><a class="opacity-75" href="/p/PMing">Lessons from Product Managing</a><a class="opacity-75" href="/p/einsum">Einsum</a><a class="opacity-75" href="/p/entropy">Entropy</a><a class="opacity-75" href="/p/_sudo">Try again with sudo: _sudo</a><a class="opacity-75" href="/p/competition-focus">Roku &amp; Competition</a></div></div></div><div class="mb-10"><article class="max-w-2xl mx-auto px-3 mt-4"><header><div class="italic opacity-75 mt-10 mb-5"><time>2023-10-26</time></div><h1 class="text-8xl w-3/4 font-junicode mb-10">Rendevous Hashing</h1></header><section class="prose dark:prose-invert prose-a:text-blue-600 dark:prose-a:text-blue-500 hover:prose-a:text-blue-900 hover:dark:prose-a:text-blue-800 dark:prose-pre:border-gray-900 dark:prose-pre:border"><p><em>This is a follow up to my post on <a href="/p/consistent-hashing">Consistent Hashing</a> -- see that first</em></p>
<p>Consistent hashing is a technique used for distributed hash tables that assigns each key to a server in the network. It does this by hashing everything and assigning each key to the closest succeeding server hash value. Rendevous hashing is the generalization of this concept to assign a key to <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> nodes. You can think about wanting to replicate a file (where it's name is the key) across <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> servers -- you need something more than consistent hashing. Another situation is where you expect that only a small number of nodes will not be part of the network at any given time (e.g., because failure probability is low but non-zero, and nodes come back over time); in this case consistent hashing would require you to rapidly reconstruct each server's mapping from key ranges to servers so that you can still query for the key from any node. Rendevous hashing solves this inefficiency by storing more keys, but preserving the nice properties of load-balancing and consistency that consistent hashing provides..</p>
<p>The idea behindrendevous hashing is that each server assigns scores to all servers (including itself) for a given key. Then they route the key to the top scorer (or to the top k, if you are rendevous hashing for replication). In particular this scoring set up needs to be <em>consistent</em> in that servers need to be able to agree on their score. It should also be even for load-balancing purposes. The scoring mechanism that fulfills both these things is simply the hash of the server's id concatenated to the key in question.</p>
<p>Read more on Randorithms.com, who has a much better <a href="https://randorithms.com/2020/12/26/rendezvous-hashing.html">write up</a>.</p></section></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Rendevous Hashing","date":"2023-10-26","slug":"rendevous-hashing","content":"\u003cp\u003e\u003cem\u003eThis is a follow up to my post on \u003ca href=\"/p/consistent-hashing\"\u003eConsistent Hashing\u003c/a\u003e -- see that first\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eConsistent hashing is a technique used for distributed hash tables that assigns each key to a server in the network. It does this by hashing everything and assigning each key to the closest succeeding server hash value. Rendevous hashing is the generalization of this concept to assign a key to \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e nodes. You can think about wanting to replicate a file (where it's name is the key) across \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e servers -- you need something more than consistent hashing. Another situation is where you expect that only a small number of nodes will not be part of the network at any given time (e.g., because failure probability is low but non-zero, and nodes come back over time); in this case consistent hashing would require you to rapidly reconstruct each server's mapping from key ranges to servers so that you can still query for the key from any node. Rendevous hashing solves this inefficiency by storing more keys, but preserving the nice properties of load-balancing and consistency that consistent hashing provides..\u003c/p\u003e\n\u003cp\u003eThe idea behindrendevous hashing is that each server assigns scores to all servers (including itself) for a given key. Then they route the key to the top scorer (or to the top k, if you are rendevous hashing for replication). In particular this scoring set up needs to be \u003cem\u003econsistent\u003c/em\u003e in that servers need to be able to agree on their score. It should also be even for load-balancing purposes. The scoring mechanism that fulfills both these things is simply the hash of the server's id concatenated to the key in question.\u003c/p\u003e\n\u003cp\u003eRead more on Randorithms.com, who has a much better \u003ca href=\"https://randorithms.com/2020/12/26/rendezvous-hashing.html\"\u003ewrite up\u003c/a\u003e.\u003c/p\u003e"},"morePosts":[{"title":"Consistent Hashing","slug":"consistent-hashing","date":"2023-10-26"},{"title":"Rendevous Hashing","slug":"rendevous-hashing","date":"2023-10-26"},{"title":"Python Coroutines!?!?","slug":"py-generator-couroutines","date":"2023-06-11"},{"title":"Lessons from Product Managing","slug":"PMing","date":"2023-06-01"},{"title":"Einsum","slug":"einsum","date":"2022-03-14"},{"title":"Entropy","slug":"entropy","date":"2021-12-28"},{"title":"Try again with sudo: _sudo","slug":"_sudo","date":"2021-11-11"},{"title":"Roku \u0026 Competition","slug":"competition-focus","date":"2021-11-11"}]},"__N_SSG":true},"page":"/p/[slug]","query":{"slug":"rendevous-hashing"},"buildId":"BneLi1I7rvmm171Kn3ut3","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>